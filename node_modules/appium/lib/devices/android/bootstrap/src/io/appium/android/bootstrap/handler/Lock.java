package io.appium.android.bootstrap.handler;

import static io.appium.android.bootstrap.utils.API.API_18;
import android.os.RemoteException;

import com.android.uiautomator.core.UiDevice;

import io.appium.android.bootstrap.AndroidCommand;
import io.appium.android.bootstrap.AndroidCommandResult;
import io.appium.android.bootstrap.CommandHandler;

public class Lock extends CommandHandler{

	@Override
	public AndroidCommandResult execute(final AndroidCommand command) throws RemoteException, InterruptedException {
		// method was only introduced in API Level 18
	    if (!API_18) {
	      return getErrorResult("Unable to open notifications on device below API level 18");
	    }
	    // does not make sense on an element
	    if (command.isElementCommand()) {
	      return getErrorResult("Unable to lock device with an element.");
	    }
	    final UiDevice device = UiDevice.getInstance();
	    device.sleep();
	    device.wait(500);
	    if (!device.isScreenOn()) {
			return getSuccessResult(true);
		}
	    else {
			return getErrorResult("Device fail to lock");
		}
	}
}
